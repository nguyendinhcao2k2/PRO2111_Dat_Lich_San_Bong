<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="description" content=""/>
    <meta
            name="author"
            content="Mark Otto, Jacob Thornton, and Bootstrap contributors"
    />
    <meta name="generator" content="Hugo 0.84.0"/>
    <link rel="website icon" type="png"
          href="https://img.freepik.com/premium-vector/soccer-ball-logo-illustration-vector_472355-210.jpg?w=2000">

    <title>Sân Bóng Đồng Đế</title>
    <link
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css"
            rel="stylesheet"
    />


    <!-- Icon Font AWESOME Bắt buộc có hai bản 5.10 và 6.2 -->
    <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"
            integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
    />
    <link
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css"
            rel="stylesheet"
    />

    <!-- BOOTSTRAP -->
    <link rel="stylesheet" th:href="@{/static/css/bootstrap.min.css}"/>
    <link rel="stylesheet" th:href="@{/static/css/bootstrap.min.css}"/>
    <!-- BOOTSTRAP -->

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com"/>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
    <link
            href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;500&family=Roboto:wght@400;500;700&display=swap"
            rel="stylesheet"
    />
    <!-- Google -->


    <!-- table icon -->
    <link
            rel="stylesheet"
            href="https://fonts.googleapis.com/icon?family=Material+Icons"
    />
    <!-- table icon -->
    <link rel="stylesheet" th:href="@{/static/css/staff/danh-sach-hoa-don-staff.css}"/>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>

    <style>
        .selected-row {
            background-color: #d3d3d3;
        }
    </style>

</head>

<body>
<header th:insert="~{fragments/header-admin}"></header>

<div class="table-wrapper">
    <div class="container-fluid">
        <!-- Other content of your page goes here -->
        <div
                id="toastContainer"
                class="position-fixed osition-absolute top-0 end-0 p-3"
                style="z-index: 9999"
        >
            <div id="toasts" class="d-flex flex-column-reverse"></div>
        </div>
    </div>
    <div class="table-title">
        <!--    row 1-->
        <div class="row">
            <div class="col-md-4">
                <h2 style="color: #fff">Hóa Đơn Đặt Lịch</h2>
            </div>
            <div class="col-md-8">
                <!--                <a href="#" class="btn btn-primary btn-refresh"-->
                <!--                ><i class="material-icons">&#xE863;</i>-->
                <!--                    <span>Refresh List</span></a-->
                <!--                >-->
                <!--                <a href="#" class="btn btn-secondary btn-export-excel"-->
                <!--                ><i class="material-icons">&#xE24D;</i>-->
                <!--                    <span>Export to Excel</span></a-->
                <!--                >-->
            </div>
        </div>
    </div>

    <!--    row2 -->
    <div class="row">
        <!--        col chung cho table, thông tin, và list servie của từng hóa đơn-->
        <div class="col-md-12">
            <div class="row">
                <!--                BEGIN COL-MD-9 Table, List--->
                <div class="col-md-9">
                    <div class="row">
                        <!-- col-md-12 TABLE -->
                        <div class="col-md-12">
                            <!-- ADD BODY ROW COL BÊN NGOÀI UPDATE THÊM HEADER THẺ DIV table table-striped table-hover -->
                            <div class="body-row-col">
                                <div class="row header-border">
                                    <div class="col-md-2">
                                        <div class="header-row-col">
                                            <h1>Danh Sách Hóa Đơn</h1>
                                        </div>
                                    </div>
                                    <div class="col-md-5">
                                        <div class="header-row-col">
                                            <button type="button" class="btn btn-success" onclick="thongBao()">
                                                ReLoad Page
                                                <i class="bi bi-arrow-clockwise"></i>
                                            </button>
                                            <button id="selectAllCheckbox" class="btn btn-success" type="submit">
                                                Select All
                                            </button>
                                            <button id="deselectAllCheckbox" class="btn btn-success" type="submit">
                                                Deselect All
                                            </button>
                                        </div>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="header-row-col">
                                            <select id="thanhToanNhieu" class="form-select" style="width: 100%">
                                                <option selected value="1">Một Hóa Đơn</option>
                                                <option value="2">Nhiều Hóa Đơn</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="col-md-3 d-flex justify-content-end">
                                        <div class="input-group mb-3">
                                            <input
                                                    type="number"
                                                    class="form-control"
                                                    id="textTimKiem"
                                                    placeholder="Tìm kiếm theo số điện thoại"
                                                    aria-label="Recipient's username"
                                                    aria-describedby="button-addon2"
                                            />
                                            <button
                                                    class="btn btn-success btn-outline-success"
                                                    type="button"
                                                    id="search"
                                                    style="
                              border-top-right-radius: 5px;
                              border-bottom-right-radius: 5px;
                            "
                                            >
                                                <i
                                                        class="fas fa-search fa-lg"
                                                        style="color: #ffffff"
                                                ></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="table-responsive ">
                                    <table
                                            class="table table-striped table-hover"
                                            id="myTable"
                                    >
                                        <tbody id="myTableBody">
                                        <!-- Nội dung cập nhật bằng JavaScript -->
                                        </tbody>
                                    </table>
                                    <!-- LAMNP UPDATE PHÂN TRANG, HIỂN THỊ SỐ BẢN GHI 02/11 -->
                                    <div class="clearfix">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div id="hienThiBanGhi">

                                                </div>
                                            </div>
                                            <div class="col-md-6 d-flex justify-content-end">
                                                <nav aria-label="Page navigation">
                                                    <ul class="pagination">
                                                        <li class="page-item">
                                                            <a
                                                                    class="page-link"
                                                                    href="#"
                                                                    aria-label="Previous"
                                                            >
                                                                <span aria-hidden="true">&laquo;</span>
                                                            </a>
                                                        </li>
                                                        <li class="page-item active">
                                                            <a class="page-link" href="#">1</a>
                                                        </li>
                                                        <li class="page-item">
                                                            <a class="page-link" href="#">2</a>
                                                        </li>
                                                        <li class="page-item">
                                                            <a class="page-link" href="#">3</a>
                                                        </li>
                                                        <li class="page-item">
                                                            <a
                                                                    class="page-link"
                                                                    href="#"
                                                                    aria-label="Next"
                                                            >
                                                                <span aria-hidden="true">&raquo;</span>
                                                            </a>
                                                        </li>
                                                    </ul>
                                                </nav>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- END UPDATE PHAN TRANG -->
                                </div>
                            </div>
                            <!-- END body-row-col  -->
                        </div>
                        <!-- END col-md-12  -->
                        <!-- col-md-12 DỊCH VỤ SỬ DỤNG -->
                        <div class="col-md-12 mt-4 mb-2">
                            <div class="body-row-col">
                                <div class="row">
                                    <div class="col-md-4 d-flex justify-content-start">
                                        <div class="header-row-col">
                                            <h1 class="">Dịch vụ sử dụng</h1>
                                        </div>
                                    </div>
                                    <div class="col-md-8">
                                        <div class="row g-2 align-items-center">
                                            <div class="col-md-6"></div>
                                            <div class="col-md-3 col-sm-auto">
                                                <select id="select-san-staff" class="form-select"
                                                        style="border-radius: 5px">
                                                    <option selected value="0">Tất cả</option>
                                                    <option value="1">Nước Uống</option>
                                                    <option value="2">Đồ Thuê</option>
                                                </select>

                                            </div>
                                            <!-- BUTTON ADD DỊCH VỤ -->
                                            <div
                                                    class="col-md-3 col-sm-auto d-flex justify-content-end"
                                            >
                                                <button
                                                        id="addDichVu"
                                                        data-bs-toggle="modal"
                                                        data-bs-target="#modalAddDichVuHoaDon"
                                                        type="button"
                                                        class="btn btn-secondary btn-labeled-sm"
                                                >
                                                    <i
                                                            class="fas fa-plus fa-lg"
                                                            style="color: #f0f2f4"
                                                    ></i>
                                                </button>
                                                <!-- MODAL ADD DỊCH VỤ -->
                                                <div
                                                        class="modal fade"
                                                        id="modalAddDichVuHoaDon"
                                                        data-bs-backdrop="static"
                                                        data-bs-keyboard="false"
                                                        tabindex="-1"
                                                        aria-labelledby="staticBackdropLabel"
                                                        aria-hidden="true"
                                                >
                                                    <div class="modal-dialog modal-xl">
                                                        <div class="modal-content">
                                                            <div class="modal-header">
                                                                <h5
                                                                        class="modal-title"
                                                                >
                                                                    Thêm dịch vụ
                                                                </h5>
                                                                <button
                                                                        type="button"
                                                                        class="btn-close"
                                                                        data-bs-dismiss="modal"
                                                                        aria-label="Close"
                                                                ></button>
                                                            </div>
                                                            <!-- BODY DICH VU-->
                                                            <div class="modal-body m-0">
                                                                <div class="body-row-col">
                                                                    <div class="row">
                                                                        <div class="col-md-9">
                                                                            <form>
                                                                                <div class="row g-2 align-items-center">
                                                                                    <!-- Sân filter -->
                                                                                    <!-- Loại Sân -->
                                                                                    <div class="col-auto">
                                                                                        <label for="select-service-list-order"
                                                                                               class="col-form-label label-filter-list-order">Dịch
                                                                                            vụ:</label>
                                                                                    </div>
                                                                                    <div class="col-md-3 col-sm-auto">
                                                                                        <select id="select-service-list-order"
                                                                                                class="form-select"
                                                                                                style="border-radius: 5px">
                                                                                            <option selected value="0">
                                                                                                Tất cả
                                                                                            </option>
                                                                                            <option value="1">Nước
                                                                                            </option>
                                                                                            <option value="2">Đồ Thuê
                                                                                            </option>
                                                                                        </select>
                                                                                    </div>
                                                                                </div>
                                                                            </form>

                                                                        </div>
                                                                        <!-- BUTTON CHECK BOX -->
                                                                        <div class="col-md-3">
                                                                            <div
                                                                                    class="d-flex justify-content-end"
                                                                            >
                                                                                <button
                                                                                        type="button"
                                                                                        id="showCheckboxButtonList"
                                                                                        class="button-header-check-box"
                                                                                >
                                                                                  <span
                                                                                          class="button-icon-check-list"
                                                                                  >
                                                                                    <i
                                                                                            class="far fa-check-square fa-lg"
                                                                                    ></i>
                                                                                  </span>
                                                                                </button>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                                <!--  -->
                                                                <div class="row mt-3 scrollable-content"
                                                                     id="dataDichVuDoThueNuocUong">

                                                                </div>
                                                            </div>
                                                            <!-- END BODY -->
                                                            <div class="modal-footer">
                                                                <button
                                                                        id="xacNhanDichVuAddNew"
                                                                        type="button"
                                                                        class="btn btn-primary btn-labeled-sm"
                                                                        data-bs-dismiss="modal"
                                                                >
                                                                    Xác Nhận
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!--  -->
                                            </div>
                                            <!-- END BUTTON ADD DỊCH VỤ -->
                                        </div>
                                    </div>
                                </div>
                                <div class="body-dich-vu header-border-content-dich-vu">
                                    <div class="row mt-3 scrollable-content" id="dataThongBao">
                                    </div>
                                    <div class="row mt-3 scrollable-content" id="dataNuocUong">
                                    </div>
                                    <hr>
                                    <div class="row mt-3 scrollable-content" id="dataDoThue">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- END col-md-12 -->
                    </div>
                </div>
                <!--                END COL-MD-9 Table, List-->
                <!--               BEGIN COL-MD-3 Hiển THị thông tin-->
                <div class="col-md-3">
                    <div class="body-row-col" id="thongTinThanhToanMot">
                        <div class="info-display">
                            <div class="header-border">
                                <h1>Thông Tin Hóa Đơn</h1>
                            </div>
                            <form method="GET">
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label for="tenKhachHang" class="form-label"
                                        >Tên Khách Hàng</label
                                        >
                                        <input
                                                type="text"
                                                class="form-control"
                                                id="tenKhachHang"
                                                readonly
                                        />
                                    </div>
                                    <div class="col-md-6">
                                        <label for="soDienThoai" class="form-label"
                                        >Số Điện Thoại</label
                                        >
                                        <input
                                                type="text"
                                                class="form-control"
                                                id="soDienThoai"
                                                readonly
                                        />
                                    </div>
                                </div>
                                <br>
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label for="tenSan" class="form-label">Tên Sân Ca</label>
                                        <input
                                                type="text"
                                                class="form-control"
                                                id="tenSan"
                                                readonly
                                        />
                                    </div>
                                    <div class="col-md-6">
                                        <label for="thoiGianDa" class="form-label"
                                        >Thời Gian Đá</label
                                        >
                                        <input
                                                type="text"
                                                class="form-control"
                                                id="thoiGianDa"
                                                readonly
                                        />
                                    </div>
                                </div>
                                <br>
                                <hr>
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label for="thoiGianCheckIn" class="form-label"
                                        >Thời Gian Check In</label
                                        >
                                        <input
                                                readonly
                                                type="text"
                                                class="form-control"
                                                id="thoiGianCheckIn"
                                        />
                                    </div>
                                    <div class="col-md-6">
                                        <label for="tienCocThua" class="form-label">Tiền Cọc Thừa (5)</label>
                                        <div class="input-group">
                                            <input
                                                    type="text"
                                                    class="form-control"
                                                    id="tienCocThua"
                                                    readonly
                                            />
                                            <span
                                                    class="input-group-text"
                                                    style="
                                                border-top-right-radius: 5px;
                                                border-bottom-right-radius: 5px;
                                              "
                                            >VND</span
                                            >
                                        </div>
                                    </div>
                                </div>
                                <hr>
                                <br>
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label for="tienSan" class="form-label">Giá Sân (1) </label>
                                        <div class="input-group">
                                            <input
                                                    type="text"
                                                    class="form-control"
                                                    id="tienSan"
                                                    readonly
                                            />
                                            <span
                                                    class="input-group-text"
                                                    style="
                                                border-top-right-radius: 5px;
                                                border-bottom-right-radius: 5px;
                                              "
                                            >VND</span
                                            >
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="tienDichVu" class="form-label">Giá Dịch Vụ (2) </label>
                                        <div class="input-group">
                                            <input
                                                    type="text"
                                                    class="form-control"
                                                    id="tienDichVu"
                                                    readonly
                                            />
                                            <span
                                                    class="input-group-text"
                                                    style="
                                                border-top-right-radius: 5px;
                                                border-bottom-right-radius: 5px;
                                              "
                                            >VND</span
                                            >
                                        </div>
                                    </div>
                                </div>
                                <hr>
                                <br>
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label for="tienDichVu" class="form-label">Tiền Phụ Phí (3)</label>
                                        <div class="input-group">
                                            <input
                                                    type="text"
                                                    class="form-control"
                                                    id="tienPhuPhi"
                                                    readonly
                                            />
                                            <span
                                                    class="input-group-text"
                                                    style="
                                                border-top-right-radius: 5px;
                                                border-bottom-right-radius: 5px;
                                              "
                                            >VND</span
                                            >
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="tienSan" class="form-label">Tiền Cọc Sân (4)</label>
                                        <div class="input-group">
                                            <input
                                                    type="text"
                                                    class="form-control"
                                                    id="tienCocSan"
                                                    readonly
                                            />
                                            <span
                                                    class="input-group-text"
                                                    style="
                                                border-top-right-radius: 5px;
                                                border-bottom-right-radius: 5px;
                                              "
                                            >VND</span
                                            >
                                        </div>
                                    </div>
                                </div>
                                <div class="row mt-4">
                                    <div class="col-md-12">
                                        <h1>Thanh Toán</h1>
                                    </div>
                                    <hr/>

                                    <div class="col-md-12">
                                        <!--Phụ Phí  -->
                                        <div class="row mb-3">
                                            <label
                                                    for="selectPhuPhi"
                                                    class="col-md-4 col-form-label"
                                            >Phụ phí</label
                                            >
                                            <div class="col-md-8">
                                                <div class="input-group">
                                                    <select id="selectPhuPhi" class="form-select"
                                                            aria-label="Default select example">
                                                        <option selected>Chọn Phụ Phí</option>
                                                    </select>
                                                    <!--  -->
                                                    <button
                                                            class="btn btn-success btn-outline-success"
                                                            type="button"
                                                            id="buttonThemPhuPhiHoaDon"
                                                            data-bs-toggle="modal"
                                                            data-bs-target="#modalThemPhuPhi"
                                                            style="
                                                              border-top-right-radius: 5px;
                                                              border-bottom-right-radius: 5px;
                                                            "
                                                    >
                                                        <i
                                                                class="fas fa-plus fa-lg"
                                                                style="color: #ffffff"
                                                        ></i>
                                                    </button>
                                                    <!-- MODAL -->
                                                    <div
                                                            class="modal fade"
                                                            id="modalThemPhuPhi"
                                                            data-bs-backdrop="static"
                                                            data-bs-keyboard="false"
                                                            tabindex="-1"
                                                            aria-labelledby="staticBackdropLabel"
                                                            aria-hidden="true"
                                                    >
                                                        <div class="modal-dialog">
                                                            <div class="modal-content">
                                                                <div class="modal-header">
                                                                    <h5
                                                                            class="modal-title"
                                                                            id="staticBackdropLabel"
                                                                    >
                                                                        Thêm phụ phí
                                                                    </h5>
                                                                    <button
                                                                            type="button"
                                                                            class="btn-close"
                                                                            data-bs-dismiss="modal"
                                                                            aria-label="Close"
                                                                    ></button>
                                                                </div>

                                                                <form>
                                                                    <div class="modal-body">
                                                                        <div class="row">
                                                                            <div class="col-md-12">
                                                                                <label
                                                                                        for="tenPhuPhi"
                                                                                        class="form-label"
                                                                                >Tên phụ phí</label
                                                                                >
                                                                                <div class="input-group">
                                                                                    <input
                                                                                            type="text"
                                                                                            class="form-control"
                                                                                            id="tenPhuPhi"

                                                                                    />
                                                                                </div>
                                                                            </div>
                                                                            <div class="col-md-12">
                                                                                <label
                                                                                        for="giaPhuPhi"
                                                                                        class="form-label"
                                                                                >Giá phụ phí</label
                                                                                >
                                                                                <div class="input-group">
                                                                                    <input
                                                                                            type="number"
                                                                                            class="form-control"
                                                                                            id="giaPhuPhi"
                                                                                            min="1"
                                                                                    />
                                                                                    <span
                                                                                            class="input-group-text"
                                                                                            style="
                                                                                              border-top-right-radius: 5px;
                                                                                              border-bottom-right-radius: 5px;
                                                                                            "
                                                                                            id="basic-addon2"
                                                                                    >VND</span
                                                                                    >
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                        <hr>
                                                                        <button type="button" class="btn btn-success"
                                                                                id="saveNewPhuPhi">
                                                                            Thêm Vào Phụ Phí
                                                                        </button>
                                                                        <hr>
                                                                        <table class="table" id="tablePhuPhi">
                                                                            <thead>
                                                                            <tr>
                                                                                <th scope="col">Stt</th>
                                                                                <th scope="col">Tên Phụ Phí</th>
                                                                                <th scope="col">Gía Phụ Phí</th>
                                                                                <th scope="col">Chọn</th>
                                                                            </tr>
                                                                            </thead>
                                                                            <tbody id="dataPhuPhiHoaDon">
                                                                            </tbody>
                                                                            <div id="thongBaoPhuPhi"></div>
                                                                        </table>
                                                                    </div>
                                                                    <div class="modal-footer">
                                                                        <button
                                                                                type="button"
                                                                                data-bs-dismiss="modal"
                                                                                class="btn btn-success btn-labeled-sm"
                                                                        >
                                                                            Xác Nhận
                                                                        </button>
                                                                    </div>
                                                                </form>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <!-- END MODAL -->
                                                </div>
                                            </div>
                                        </div>
                                        <hr>
                                        <br>
                                        <!-- phương thức chuyển khoản -->
                                        <fieldset class="row mb-3">
                                            <legend class="col-form-label col-md-4 pt-0">
                                                Hình Thức :
                                            </legend>
                                            <div class="col-md-8">
                                                <div class="form-check form-check-inline">
                                                    <input
                                                            class="form-check-input"
                                                            type="radio"
                                                            name="phuongThucChuyenKhoan"
                                                            id="chuyenKhoan"
                                                            value="chuyenKhoan"
                                                            checked
                                                            onchange="toggleInputs()"
                                                    />
                                                    <label class="form-check-label" for="chuyenKhoan">
                                                        Chuyển khoản
                                                    </label>
                                                </div>
                                                <div class="form-check form-check-inline">
                                                    <input
                                                            class="form-check-input"
                                                            type="radio"
                                                            name="phuongThucChuyenKhoan"
                                                            id="tienMat"
                                                            value="tienMat"
                                                            onchange="toggleInputs()"
                                                    />
                                                    <label class="form-check-label" for="tienMat">
                                                        Tiền mặt
                                                    </label>
                                                </div>
                                            </div>
                                        </fieldset>
                                        <!-- Tiền khách đưa -->
                                        <div id="tienKhachDuaContainer">
                                            <div class="row mb-3">
                                                <label for="tienKhachDua" class="col-md-4 col-form-label"
                                                >Tiền khách đưa</label
                                                >
                                                <div class="col-md-8">
                                                    <div class="input-group">
                                                        <input
                                                                type="number"
                                                                class="form-control"
                                                                id="tienKhachDua"
                                                                min="0"
                                                                oninput="calculateChange()"
                                                        />
                                                        <span
                                                                class="input-group-text"
                                                                style="
                              border-top-right-radius: 5px;
                              border-bottom-right-radius: 5px;
                            "
                                                                id="basic-addon3"
                                                        >VND</span
                                                        >
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row mb-3">
                                                <label for="tienTraLai" class="col-md-4 col-form-label"
                                                >Tiền trả lại</label
                                                >
                                                <div class="col-md-8">
                                                    <div class="input-group">
                                                        <input
                                                                readonly
                                                                type="text"
                                                                class="form-control"
                                                                id="tienTraLai"
                                                        />
                                                        <span
                                                                class="input-group-text"
                                                                style="
                                                              border-top-right-radius: 5px;
                                                              border-bottom-right-radius: 5px;
                                                            "
                                                        >VND</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- tổng tiền -->
                                    <div class="col-md-12">
                                        <hr/>
                                        <h3
                                                style="
                                                font-size: 19px;
                                                font-family: Tahoma;
                                                font-weight: 600;
                                                text-align: center;
                                                color: rgb(215, 92, 92);
                                              "
                                        >
                                            ((1 + 2 + 3) - (4 + 5)):
                                        </h3>
                                        <h1
                                                style="
                                                font-size: 22px;
                                                font-family: Tahoma;
                                                font-weight: 900;
                                                text-align: center;
                                                color: rgb(215, 92, 92);
                                              "
                                        >
                                            <br>
                                            Tổng Thanh Toán: <span id="tongThanhToan">0</span>
                                        </h1>
                                    </div>
                                </div>
                                <!-- BUTTON NEW 2/11 -->
                                <hr/>
                                <div class="mt-2 d-grid gap-2 d-md-block d-flex justify-content-center text-center">
                                    <button
                                            type="button "
                                            class="m-2 btn btn-danger btn-labeled"
                                    >
                                        Hủy
                                        <span class="btn-label">
                                        <i class="fa fa-remove"></i>
                                         </span>
                                    </button>
                                    <button
                                            type="submit"
                                            id="btnThanhToanHoaDon"
                                            class="m-2 btn btn-success btn-labeled"
                                    >
                                        Thanh Toán
                                        <span class="btn-label"
                                        ><i class="fas fa-money-bill fa-lg"></i
                                        ></span>
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                    <div class="body-row-col" id="thongTinThanhToanNhieu">
                        <div class="info-display">
                            <div class="header-border">
                                <h1>Thông Tin Hóa Đơn</h1>
                            </div>
                            <form method="GET">
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label for="tenKhachHangNhieu" class="form-label"
                                        >Tên Khách Hàng</label
                                        >
                                        <input
                                                type="text"
                                                class="form-control"
                                                id="tenKhachHangNhieu"
                                                readonly
                                        />
                                    </div>
                                    <div class="col-md-6">
                                        <label for="soDienThoaiNhieu" class="form-label"
                                        >Số Điện Thoại</label
                                        >
                                        <input
                                                type="text"
                                                class="form-control"
                                                id="soDienThoaiNhieu"
                                                readonly
                                        />
                                    </div>
                                </div>
                                <br>
                                <hr>
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label for="tienSan" class="form-label">Giá Sân (1) </label>
                                        <div class="input-group">
                                            <input
                                                    type="text"
                                                    class="form-control"
                                                    id="tienSanNhieu"
                                                    readonly
                                            />
                                            <span
                                                    class="input-group-text"
                                                    style="
                                                border-top-right-radius: 5px;
                                                border-bottom-right-radius: 5px;
                                              "
                                            >VND</span
                                            >
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="tienDichVu" class="form-label">Giá Dịch Vụ (2) </label>
                                        <div class="input-group">
                                            <input
                                                    type="text"
                                                    class="form-control"
                                                    id="tienDichVuNhieu"
                                                    readonly
                                            />
                                            <span
                                                    class="input-group-text"
                                                    style="
                                                border-top-right-radius: 5px;
                                                border-bottom-right-radius: 5px;
                                              "
                                            >VND</span
                                            >
                                        </div>
                                    </div>
                                </div>
                                <br>
                                <hr>
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label for="tienDichVu" class="form-label">Tiền Phụ Phí (3)</label>
                                        <div class="input-group">
                                            <input
                                                    type="text"
                                                    class="form-control"
                                                    id="tienPhuPhiNhieu"
                                                    readonly
                                            />
                                            <span
                                                    class="input-group-text"
                                                    style="
                                                border-top-right-radius: 5px;
                                                border-bottom-right-radius: 5px;
                                              "
                                            >VND</span
                                            >
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <label for="tienSan" class="form-label">Tiền Cọc Sân (4)</label>
                                        <div class="input-group">
                                            <input
                                                    type="text"
                                                    class="form-control"
                                                    id="tienCocSanNhieu"
                                                    readonly
                                            />
                                            <span
                                                    class="input-group-text"
                                                    style="
                                                border-top-right-radius: 5px;
                                                border-bottom-right-radius: 5px;
                                              "
                                            >VND</span
                                            >
                                        </div>
                                    </div>
                                    <br>
                                    <hr>
                                    <div class="row g-3">
                                        <div class="col-md-12">
                                            <label for="tienCocThuaNhieu" class="form-label">Tiền Cọc Thừa (5)</label>
                                            <div class="input-group">
                                                <input
                                                        type="text"
                                                        class="form-control"
                                                        id="tienCocThuaNhieu"
                                                        readonly
                                                />
                                                <span
                                                        class="input-group-text"
                                                        style="
                                                border-top-right-radius: 5px;
                                                border-bottom-right-radius: 5px;
                                              "
                                                >VND</span
                                                >
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row mt-4">
                                    <div class="col-md-12">
                                        <h1>Thanh Toán</h1>
                                    </div>
                                    <!-- tổng tiền -->
                                    <div class="col-md-12">
                                        <hr/>
                                        <h3
                                                style="
                                                font-size: 19px;
                                                font-family: Tahoma;
                                                font-weight: 600;
                                                text-align: center;
                                                color: rgb(215, 92, 92);
                                              "
                                        >
                                            ((1 + 2 + 3) - (4 + 5)):
                                        </h3>
                                        <h1
                                                style="
                                                font-size: 22px;
                                                font-family: Tahoma;
                                                font-weight: 900;
                                                text-align: center;
                                                color: rgb(215, 92, 92);
                                              "
                                        >
                                            <br>
                                            Tổng Thanh Toán: <span id="tongThanhToanNhieu">0</span>
                                        </h1>
                                    </div>
                                </div>
                                <!-- BUTTON NEW 2/11 -->
                                <br>
                                <hr/>
                                <div class="mt-2 d-grid gap-2 d-md-block d-flex justify-content-center text-center">
                                    <button
                                            type="button "
                                            class="m-2 btn btn-danger btn-labeled"
                                    >
                                        Hủy
                                        <span class="btn-label">
                                        <i class="fa fa-remove"></i>
                                         </span>
                                    </button>
                                    <button
                                            type="submit"
                                            id="btnThanhToanHoaDonNhieu"
                                            class="m-2 btn btn-success btn-labeled"
                                    >
                                        Thanh Toán
                                        <span class="btn-label"
                                        ><i class="fas fa-money-bill fa-lg"></i
                                        ></span>
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                <!--                END Hiển thị thông tin-->
            </div>
        </div>
    </div>
</div>

<script>
    const showCheckboxButtonList = document.getElementById(
        "showCheckboxButtonList"
    );
    const checkboxContainerList = document.getElementById(
        "checkboxContainerList"
    );
    showCheckboxButtonList.addEventListener("click", function () {
        // Toggle the display of the checkbox container
        if (checkboxContainerList.style.display === "none") {
            checkboxContainerList.style.display = "block";
        } else {
            checkboxContainerList.style.display = "none";
        }
    });
    //
    var tongTienHoaDonPhaiTra = 0;
    var tongTienSanCaSaveThongKe = 0;
    $(document).ready(function () {
        clearTienKhachDua();
        var getId;
        var tongTienDichVu = 0;
        var tongTienSanCa = 0;
        var tongTienCoc = 0;
        var tongTienCocThua = 0;
        var tongGiaTienPhuPhi = 0;
        showDataTableViewThanhToan();

        $('#addDichVu').on('click', function () {
            processSelectChange();
        });

        $('#xacNhanDichVuAddNew').on('click', function () {
            displayDichVu();
        });
        $(document).on('click', '#addDichVuHoaDon', function () {
            Swal.fire({
                title: 'Xác Nhận Thêm Dịch Vụ!',
                text: 'Xin chào!',
                icon: 'success',
                confirmButtonText: 'Dồng Ý'
            }).then((result) => {
                if (result.isConfirmed) {
                    var card = $(this).closest('.card-product');
                    var soLuong = card.find('.soluong').val();
                    var tenDichVu = $(this).data('ten-dich-vu');
                    var idDichVuSuDung = $(this).data('id');
                    var trangThaiDichVu = $(this).data('trang-thai');
                    var giaDichVu = $(this).data('gia-dich-vu');
                    clearTienKhachDua();
                    $.ajax({
                        url: '/api/v1/staff/dich-vu-san-bong/them-dich-vu-hoa-don/' + getId,
                        method: 'POST',
                        contentType: 'application/json',
                        data: JSON.stringify({
                            soLuong: soLuong,
                            id: idDichVuSuDung,
                            trangThai: trangThaiDichVu
                        }),
                        success: function (response) {
                            processSelectChange();
                            displayDichVu();
                        },
                        error: function (error) {
                            console.error('API Request Failed:', error);
                        }
                    });
                    createAndShowToast('bg-success', 'Thêm Dịch Vụ Thành Công :', tenDichVu + ' : ' + formatCurrencyVND(giaDichVu) + '.VNĐ' + ' Số Lượng: ' + soLuong);
                }
            });
        });
        $(document).on('click', '#buttonXoa', function () {
            Swal.fire({
                title: 'Xác Nhận Xóa Dịch Vụ!',
                text: 'Xin chào!',
                icon: 'success',
                confirmButtonText: 'Đồng Ý'
            }).then((result) => {
                if (result.isConfirmed) {
                    var idDichVuSuDung = $(this).data('id');
                    var card = $(this).closest('.card-product');
                    var soLuong = card.find('.soluong').val();
                    var tenDichVu = $(this).data('ten-dich-vu');
                    var trangThaiDichVu = $(this).data('trang-thai');
                    $.ajax({
                        url: '/api/v1/staff/dich-vu-san-bong/xoa-dich-vu/' + getId,
                        method: 'POST',
                        contentType: 'application/json',
                        data: JSON.stringify({
                            id: idDichVuSuDung,
                            soLuong: soLuong,
                            trangThai: trangThaiDichVu
                        }),
                        success: function (response) {
                            displayDichVu();
                        },
                        error: function (error) {
                            console.error('API Request Failed:', error);
                        }
                    });
                    createAndShowToast('bg-success', 'Xóa Dịch Vụ Thành Công :', tenDichVu + ' : ' + ' Số Lượng: ' + soLuong);
                }
            });
        });
        $(document).on('click', '#buttonCapNhat', function () {
            Swal.fire({
                title: 'Xác Nhận Cập Nhật Dịch Vụ!',
                text: 'Xin chào!',
                icon: 'success',
                confirmButtonText: 'Đồng Ý'
            }).then((result) => {
                if (result.isConfirmed) {
                    var idDichVuSuDung = $(this).data('id');
                    var card = $(this).closest('.card-product');
                    var soLuong = card.find('.soluong').val();
                    var trangThaiDichVu = $(this).data('trang-thai');
                    var tenDichVu = $(this).data('ten-dich-vu');
                    var giaDichVu = $(this).data('gia-dich-vu');
                    $.ajax({
                        url: '/api/v1/staff/dich-vu-san-bong/cap-nhat-so-luong-dich-vu/' + getId,
                        method: 'POST',
                        contentType: 'application/json',
                        data: JSON.stringify({
                            id: idDichVuSuDung,
                            soLuong: soLuong,
                            trangThai: trangThaiDichVu
                        }),
                        success: function (response) {
                            displayDichVu();
                        },
                        error: function (error) {
                            console.error('API Request Failed:', error);
                        }
                    });
                    createAndShowToast('bg-success', 'Cập Nhật Số Lượng Thành Công :', tenDichVu + ' : ' + formatCurrencyVND(giaDichVu) + '.VNĐ' + ' Số Lượng: ' + soLuong);
                }
            });
        });

        function displayDichVu() {
            tongTienDichVu = 0;
            clearTienKhachDua();
            $.ajax({
                url: '/api/v1/staff/dich-vu-san-bong/dich-vu-thanh-toan/' + getId,
                method: 'GET',
                success: function (apiResponse) {
                    $('#dataNuocUong').empty();
                    $('#dataDoThue').empty();
                    $('#tienTraLai').empty();
                    $('#tienKhachDua').empty();
                    if (apiResponse && Array.isArray(apiResponse) && apiResponse.length > 0) {
                        $('#dataThongBao').empty();
                        apiResponse.forEach(function (item) {
                            var idNuocUong = item.idNuocUong;
                            if (idNuocUong != null && idNuocUong != '') {
                                var imageNuocUong = item.imageNuocUong;
                                var tenNuocUong = item.tenNuocUong;
                                var giaNuocUong = item.giaNuocUong;
                                var soLuongMax = item.soLuongNuocUongMax;
                                var soLuongNuocUong = item.soLuongNuocUong;
                                tongTienDichVu += (soLuongNuocUong * giaNuocUong);

                                var htmlContent = '<div class="col-md-3 col-sm-3 col-4">';
                                htmlContent += '<div class="card card-product">';
                                htmlContent += '<img src="data:image/png;base64,' + imageNuocUong + '" class="card-img-top" alt="..." />';
                                htmlContent += '<div class="card-body">';
                                htmlContent += '<h5 class="card-title text-center">' + tenNuocUong + '</h5>';
                                htmlContent += '<span class="price" type="number">' + formatCurrencyVND(giaNuocUong) + ' VNĐ</span>';
                                htmlContent += '<div class="form-group form-group-list-service-order">';
                                htmlContent += '<label class="form-label" for="quantity">Số Lượng :</label>';
                                htmlContent += '<input min="1" value="' + soLuongNuocUong + '" type="number" class="soluong" onchange="validatePositiveNumberInput(this, ' + soLuongMax + ')"  data-initial-quantity="' + soLuongNuocUong + '"/>';
                                htmlContent += '</div>';
                                htmlContent += '</div>';
                                htmlContent += '<div class="card-footer bg-white">';
                                htmlContent += '<div class="d-grid gap-2 d-md-flex justify-content-md-end">';
                                htmlContent += '<button id="buttonXoa" data-ten-dich-vu="' + tenNuocUong + '" data-id="' + idNuocUong + '" data-trang-thai="' + 1 + '" class="btn btn-danger btn-labeled-sm">Xóa</button>';
                                htmlContent += '<button id="buttonCapNhat" data-gia-dich-vu="' + giaNuocUong + '" data-ten-dich-vu="' + tenNuocUong + '" data-id="' + idNuocUong + '" data-trang-thai="' + 1 + '"  class="btn btn-success btn-labeled-sm">Cập Nhập</button>';
                                htmlContent += '</div>';
                                htmlContent += '</div>';
                                htmlContent += '</div>';
                                htmlContent += '</div>';
                                $('#dataNuocUong').append(htmlContent);
                            }
                            var idDoThue = item.idDoThue;
                            if (idDoThue != null && idDoThue != '') {
                                var imageDoThue = item.imageDoThue;
                                var giaDoThue = item.giaDoThue;
                                var tenDoThue = item.tenDoThue;
                                var soLuongMax = item.soLuongDoThueMax;
                                var soLuongDoThue = item.soLuongDoThue;
                                tongTienDichVu += (soLuongDoThue * giaDoThue);

                                var htmldoThue = '<div class="col-md-3 col-sm-3 col-4">';
                                htmldoThue += '<div class="card card-product">';
                                htmldoThue += '<img src="data:image/png;base64,' + imageDoThue + '" class="card-img-top" alt="..." />';
                                htmldoThue += '<div class="card-body">';
                                htmldoThue += '<h5 class="card-title text-center">' + tenDoThue + '</h5>';
                                htmldoThue += '<span class="price" type="number">' + formatCurrencyVND(giaDoThue) + ' VNĐ</span>';
                                htmldoThue += '<div class="form-group form-group-list-service-order">';
                                htmldoThue += '<label class="form-label" for="quantity">Số Lượng :</label>';
                                htmldoThue += '<input min="1" value="' + soLuongDoThue + '" type="number" class="soluong" onchange="validatePositiveNumberInput(this, ' + soLuongMax + ')"  data-initial-quantity="' + soLuongDoThue + '"/>';
                                htmldoThue += '</div>';
                                htmldoThue += '</div>';
                                htmldoThue += '<div class="card-footer bg-white">';
                                htmldoThue += '<div class="d-grid gap-2 d-md-flex justify-content-md-end">';
                                htmldoThue += '<button id="buttonXoa" data-ten-dich-vu="' + tenDoThue + '" data-id="' + idDoThue + '" data-trang-thai="' + 2 + '" class="btn btn-danger btn-labeled-sm">Xóa</button>';
                                htmldoThue += '<button id="buttonCapNhat" data-gia-dich-vu="' + giaDoThue + '" data-ten-dich-vu="' + tenDoThue + '" data-id="' + idDoThue + '" data-trang-thai="' + 2 + '"  class="btn btn-success btn-labeled-sm">Cập Nhập</button>';
                                htmldoThue += '</div>';
                                htmldoThue += '</div>';
                                htmldoThue += '</div>';
                                htmldoThue += '</div>';
                                $('#dataDoThue').append(htmldoThue);
                            }
                        });
                    } else {
                        $('#dataThongBao').empty();
                        var htmlThongBao = '<div class="alert alert-danger noContent" role="alert">';
                        htmlThongBao += '<h1 class="" style="font-size: 20px">Chưa Sử Dụng Dịch Vụ Nào!</h1>';
                        htmlThongBao += '</div>';
                        $('#dataThongBao').append(htmlThongBao);
                    }
                    $('#tienDichVu').val(formatCurrencyVND(tongTienDichVu));
                    tongTienSanCaSaveThongKe = (parseFloat(tongTienDichVu) + parseFloat(tongTienSanCa) + parseFloat(tongGiaTienPhuPhi) - (parseFloat(tongTienCoc) + parseFloat(tongTienCocThua)));
                    tongTienHoaDonPhaiTra = (parseFloat(tongTienDichVu) + parseFloat(tongTienSanCa) + parseFloat(tongGiaTienPhuPhi) - (parseFloat(tongTienCoc) + parseFloat(tongTienCocThua)));
                    $('#tongThanhToan').text(formatCurrencyVND((parseFloat(tongTienDichVu) + parseFloat(tongTienSanCa) + parseFloat(tongGiaTienPhuPhi) - (parseFloat(tongTienCoc) + parseFloat(tongTienCocThua)))) + '.VNĐ');
                },
                error: function (error) {
                    console.error('API Request Failed:', error);
                }
            });
        }

        $('#select-san-staff').on('change', function () {
            var selectedValue = $(this).val();
            if (selectedValue === "0") {
                $('#dataNuocUong').show();
                $('#dataDoThue').show();
            } else if (selectedValue === "1") {
                $('#dataNuocUong').show();
                $('#dataDoThue').hide();
            } else if (selectedValue === "2") {
                $('#dataNuocUong').hide();
                $('#dataDoThue').show();
            }
        });
        $(document).ready(function () {
            displayDichVu();
        });
        $('#select-service-list-order').change(function () {
            processSelectChange();
        });

        function autoSelectFirstRow() {
            var firstRow = $("#myTableBody tr:first");
            firstRow.trigger('click');
        }

        function showDataTableViewThanhToan() {
            $.get("/api/v1/staff/get-all-thanh-toan", function (data) {
                $('#thongTinThanhToanMot').show();
                $('#thongTinThanhToanNhieu').hide();
                $('#thanhToanNhieu').hide();

                var table = $("#myTable");
                // Tạo phần <thead> và các thẻ tiêu đề
                if (table.find('thead').length === 0) {
                    // Nếu chưa có, thêm mới thead
                    var thead = document.createElement('thead');
                    var headerRow = document.createElement('tr');
                    var headers = ['Tên khách', 'Số điện thoại', 'Sân ca', 'Thời gian ', 'Ngày đặt lịch', 'Trạng thái', 'Chọn Nhiều'];
                    for (var i = 0; i < headers.length; i++) {
                        var th = document.createElement('th');
                        th.scope = 'col';
                        th.textContent = headers[i];
                        headerRow.appendChild(th);
                    }
                    thead.appendChild(headerRow);
                    table.prepend(thead);
                }

                //<tbody> với dữ liệu
                var tableBody = $("#myTableBody");
                tableBody.empty();

                //mục trang và trang hiện tại
                var pageSize = 8;
                var currentPage = 1;
                var totalPages = Math.ceil(data.length / pageSize);
                if (data.length < pageSize) {
                    displayPage(data.length, data.length);
                } else {
                    displayPage(pageSize, data.length);
                }


                //hiển thị dữ liệu dựa trên trang hiện tại
                function displayData() {
                    $('#selectAllCheckbox').hide();
                    $('#deselectAllCheckbox').hide();
                    tableBody.empty();
                    var startIndex = (currentPage - 1) * pageSize;
                    var endIndex = Math.min(startIndex + pageSize, data.length);

                    for (var i = startIndex; i < endIndex; i++) {
                        var item = data[i];
                        var row = document.createElement('tr');

                        row.dataset.id = item.id;
                        row.dataset.tienCocThua = item.tienCocThua;
                        row.dataset.soDienThoai = item.soDienThoai;
                        row.dataset.tenKhachHang = item.tenKhachHang;
                        row.dataset.tenSanBong = item.tenSanBong;
                        row.dataset.tenLoaiSan = item.tenLoaiSan;
                        row.dataset.tenCa = item.tenCa;
                        row.dataset.tienCoc = item.tienCoc;
                        row.dataset.thoiGianBatDau = item.thoiGianBatDau;
                        row.dataset.thoiGianKetThuc = item.thoiGianKetThuc;
                        row.dataset.tongTienSanCa = item.tongTienSanCa;
                        row.dataset.tongTienThanhToan = item.tongTienSanCa;
                        row.dataset.thoiGianCheckIn = item.thoiGianCheckIn;
                        row.dataset.ngayDenSan = item.ngayDenSan;


                        //ô dữ liệu và thêm dữ liệu vào
                        var cell1 = document.createElement('td');
                        cell1.textContent = item.tenKhachHang;
                        var cell2 = document.createElement('td');
                        cell2.textContent = item.soDienThoai;
                        var cell3 = document.createElement('td');
                        cell3.textContent = item.tenSanBong + " - " + item.tenCa;
                        var cell4 = document.createElement('td');
                        cell4.textContent = item.thoiGianBatDau + " - " + item.thoiGianKetThuc;
                        var cell5 = document.createElement('td');
                        cell5.textContent = formatDate(item.ngayDatLich);
                        var cell6 = document.createElement('td');
                        //trạng thái và hiển thị 'true' nếu trạng thái là 1
                        cell6.textContent = item.trangThai === 1 ? 'Đã Check In' : 'Chờ Thanh Toán';
                        var cell7 = document.createElement('td');

                        //các ô vào hàng
                        row.appendChild(cell1);
                        row.appendChild(cell2);
                        row.appendChild(cell3);
                        row.appendChild(cell4);
                        row.appendChild(cell5);
                        row.appendChild(cell6);
                        row.appendChild(cell7);

                        row.addEventListener('click', function () {
                            clearTienKhachDua();
                            tongGiaTienPhuPhi = 0;
                            tableBody.find('tr').removeClass('selected-row');
                            $(this).addClass('selected-row');
                            getId = this.dataset.id;
                            tongTienCocThua = this.dataset.tienCocThua;
                            tongTienSanCa = this.dataset.tongTienSanCa;
                            tongTienCoc = this.dataset.tienCoc;
                            displayDichVu(data);
                            tongTienSanCaSaveThongKe = (parseFloat(tongTienDichVu) + parseFloat(tongTienSanCa) + parseFloat(tongGiaTienPhuPhi) - (parseFloat(tongTienCoc) + parseFloat(tongTienCocThua)));
                            displayPhuPhiHoaDon(getId);
                            $('#tienSan').val(formatCurrencyVND(this.dataset.tongTienSanCa));
                            $('#tienCocSan').val(formatCurrencyVND(this.dataset.tienCoc));
                            $('#tienCocThua').val(formatCurrencyVND(this.dataset.tienCocThua));
                            $('#tenKhachHang').val(this.dataset.tenKhachHang);
                            $('#soDienThoai').val(this.dataset.soDienThoai);
                            $('#tenSan').val(this.dataset.tenSanBong + ' - ' + this.dataset.tenCa + ' - ' + this.dataset.tenLoaiSan);
                            $('#thoiGianDa').val(this.dataset.thoiGianBatDau + ' - ' + this.dataset.thoiGianKetThuc);
                            $('#thoiGianCheckIn').val(this.dataset.ngayDenSan + ' - ' + this.dataset.thoiGianCheckIn);
                        });
                        tableBody.append(row);
                    }

                    updatePagination();
                }

                document.getElementById('search').addEventListener('click', function () {
                    searchFunction();
                });
                $(document).ready(function () {
                    // Event handler for the select all button click
                    $('#selectAllCheckbox').on('click', function () {
                        $('.checkbox-select').prop('checked', true);
                        handleCheckboxEvent();
                    });
                    $('#deselectAllCheckbox').on('click', function () {
                        $('.checkbox-select').prop('checked', false);
                        handleCheckboxEvent();
                    });
                    $('.checkbox-select').on('click', handleCheckboxEvent);
                });

                function handleCheckboxEvent() {
                    var selectedItems = [];
                    $('.checkbox-select:checked').each(function () {
                        var itemId = $(this).val();
                        selectedItems.push(itemId);

                    });
                    if (selectedItems.length === 0 || selectedItems.includes(null)) {
                        console.log("Mảng có giá trị null hoặc rỗng.");
                    } else {
                        $.ajax({
                            type: "POST",
                            contentType: "application/json",
                            url: "/api/v1/staff/thanh-toan-hoa-don-nhieu",
                            data: JSON.stringify(selectedItems),
                            success: function (response) {
                                console.log("Success:", response);
                                displayThanhToanNhieu(response);
                            },
                            error: function (error) {
                                console.error("Error:", error);
                            }
                        });
                    }
                    console.log(selectedItems);
                }

                function displayThanhToanNhieu(response) {

                    $('#tienSanNhieu').val(formatCurrencyVND(response.tongTienSanBong));
                    $('#tienCocSanNhieu').val(formatCurrencyVND(response.tongTienCoc));
                    $('#tienCocThuaNhieu').val(formatCurrencyVND(response.tongTienCocThua));
                    $('#tienPhuPhiNhieu').val(formatCurrencyVND(response.tongTienPhuPhi));
                    $('#tienDichVuNhieu').val(formatCurrencyVND(response.tongTienDichVu));
                    $('#tenKhachHangNhieu').val(response.tenKhachHang);
                    $('#soDienThoaiNhieu').val(response.soDienThoai);
                    $('#tenSanNhieu').val(response.tenSanBong);
                    var tongTienThanhToan = ((response.tongTienSanBong + response.tongTienPhuPhi + response.tongTienDichVu) - (response.tongTienCoc - response.tongTienCocThua));
                    $('#tongThanhToanNhieu').text(formatCurrencyVND(tongTienThanhToan));
                }

                var combobox = document.getElementById("thanhToanNhieu");
                combobox.addEventListener("change", function () {
                    var selectedValue = combobox.value;
                    if (selectedValue == 2) {
                        $('#selectAllCheckbox').show();
                        $('#deselectAllCheckbox').show();
                        $('.checkbox-select').show();
                        $('#thongTinThanhToanNhieu').show();
                        $('#thongTinThanhToanMot').hide();
                        $('.checkbox-select').prop('checked', false);
                        handleCheckboxEvent();
                    } else {
                        $('#selectAllCheckbox').hide();
                        $('#deselectAllCheckbox').hide();
                        $('.checkbox-select').hide();
                        $('#thongTinThanhToanNhieu').hide();
                        $('#thongTinThanhToanMot').show();
                    }
                });

                function searchFunction() {
                    $('#thanhToanNhieu').show();
                    $('.checkbox-select').hide();
                    var searchText = document.getElementById('textTimKiem').value;
                    if (!containsOnlySpaces(searchText) && isInputNumber(searchText) && isValidVietnamesePhoneNumber(searchText)) {
                        $.ajax({
                            url: "/api/v1/staff/search-by-phone",
                            method: "GET",
                            data: {
                                numberPhone: searchText
                            },
                            success: function (data) {
                                displayData(data);

                                function displayData(data) {
                                    tableBody.empty();
                                    var startIndex = (currentPage - 1) * pageSize;
                                    var endIndex = Math.min(startIndex + pageSize, data.length);
                                    if (data.length < pageSize) {
                                        displayPage(data.length, data.length);
                                    } else {
                                        displayPage(pageSize, data.length);
                                    }
                                    for (var i = startIndex; i < endIndex; i++) {
                                        var item = data[i];
                                        var row = document.createElement('tr');

                                        row.dataset.id = item.id;
                                        row.dataset.tienCocThua = item.tienCocThua;
                                        row.dataset.soDienThoai = item.soDienThoai;
                                        row.dataset.tenKhachHang = item.tenKhachHang;
                                        row.dataset.tenSanBong = item.tenSanBong;
                                        row.dataset.tenLoaiSan = item.tenLoaiSan;
                                        row.dataset.tenCa = item.tenCa;
                                        row.dataset.tienCoc = item.tienCoc;
                                        row.dataset.thoiGianBatDau = item.thoiGianBatDau;
                                        row.dataset.thoiGianKetThuc = item.thoiGianKetThuc;
                                        row.dataset.tongTienSanCa = item.tongTienSanCa;
                                        row.dataset.tongTienThanhToan = item.tongTienSanCa;
                                        row.dataset.thoiGianCheckIn = item.thoiGianCheckIn;
                                        row.dataset.ngayDenSan = item.ngayDenSan;


                                        //ô dữ liệu và thêm dữ liệu vào
                                        var cell1 = document.createElement('td');
                                        cell1.textContent = item.tenKhachHang;
                                        var cell2 = document.createElement('td');
                                        cell2.textContent = item.soDienThoai;
                                        var cell3 = document.createElement('td');
                                        cell3.textContent = item.tenSanBong + " - " + item.tenCa;
                                        var cell4 = document.createElement('td');
                                        cell4.textContent = item.thoiGianBatDau + " - " + item.thoiGianKetThuc;
                                        var cell5 = document.createElement('td');
                                        cell5.textContent = formatDate(item.ngayDatLich);
                                        var cell6 = document.createElement('td');
                                        //trạng thái và hiển thị 'true' nếu trạng thái là 1
                                        cell6.textContent = item.trangThai === 1 ? 'Đã Check In' : 'Chờ Thanh Toán';
                                        var checkboxCell = document.createElement('td');
                                        var checkboxDiv = document.createElement('div');
                                        checkboxDiv.className = 'form-check';
                                        var checkbox = document.createElement('input');
                                        checkbox.type = 'checkbox';
                                        checkbox.className = 'form-check-input checkbox-select';
                                        checkbox.value = item.id; // Đặt giá trị của checkbox là ID hoặc giá trị tương ứng từ dữ liệu
                                        checkbox.dataset.itemId = item.id;
                                        var selectedItems = [];
                                        checkbox.onclick = function () {
                                            var itemId = this.dataset.itemId;
                                            if (this.checked) {
                                                console.log('Checkbox được chọn. ID:', itemId);
                                                selectedItems.push(itemId);
                                                console.log('List được chọn. ID:', selectedItems);
                                                handleCheckboxEvent();
                                            } else {
                                                console.log('Checkbox bị bỏ chọn. ID:', itemId);
                                                var index = selectedItems.indexOf(itemId);
                                                if (index !== -1) {
                                                    selectedItems.splice(index, 1);
                                                    handleCheckboxEvent();
                                                    console.log('List được chọn. ID:', selectedItems);
                                                }
                                            }
                                        };
                                        checkboxDiv.appendChild(checkbox);

                                        var label = document.createElement('label');
                                        label.className = 'form-check-label';
                                        label.setAttribute('for', 'checkbox_' + item.id);

                                        checkboxDiv.appendChild(checkbox);
                                        checkboxDiv.appendChild(label);
                                        checkboxCell.appendChild(checkboxDiv);

                                        // ... (các sự kiện và cập nhật khác)
                                        //các ô vào hàng
                                        row.appendChild(cell1);
                                        row.appendChild(cell2);
                                        row.appendChild(cell3);
                                        row.appendChild(cell4);
                                        row.appendChild(cell5);
                                        row.appendChild(cell6);
                                        row.appendChild(checkboxCell);

                                        row.addEventListener('click', function () {
                                            clearTienKhachDua();
                                            tongGiaTienPhuPhi = 0;
                                            tableBody.find('tr').removeClass('selected-row');
                                            $(this).addClass('selected-row');
                                            getId = this.dataset.id;
                                            tongTienCocThua = this.dataset.tienCocThua;
                                            tongTienSanCa = this.dataset.tongTienSanCa;
                                            tongTienCoc = this.dataset.tienCoc;
                                            displayDichVu(data);
                                            tongTienSanCaSaveThongKe = (parseFloat(tongTienDichVu) + parseFloat(tongTienSanCa) + parseFloat(tongGiaTienPhuPhi) - (parseFloat(tongTienCoc) + parseFloat(tongTienCocThua)));
                                            displayPhuPhiHoaDon(getId);
                                            $('#tienSan').val(formatCurrencyVND(this.dataset.tongTienSanCa));
                                            $('#tienCocSan').val(formatCurrencyVND(this.dataset.tienCoc));
                                            $('#tienCocThua').val(formatCurrencyVND(this.dataset.tienCocThua));
                                            $('#tenKhachHang').val(this.dataset.tenKhachHang);
                                            $('#soDienThoai').val(this.dataset.soDienThoai);
                                            $('#tenSan').val(this.dataset.tenSanBong + ' - ' + this.dataset.tenCa + ' - ' + this.dataset.tenLoaiSan);
                                            $('#thoiGianDa').val(this.dataset.thoiGianBatDau + ' - ' + this.dataset.thoiGianKetThuc);
                                            $('#thoiGianCheckIn').val(this.dataset.ngayDenSan + ' - ' + this.dataset.thoiGianCheckIn);
                                        });
                                        tableBody.append(row);
                                    }
                                    autoSelectFirstRow();
                                    updatePagination();
                                    $('.checkbox-select').hide();
                                }
                            },
                            error: function (error) {
                                console.log("Error:", error);
                            }
                        });
                    } else {
                        $('#textTimKiem').val('');
                        createAndShowToast('bg-warning', 'Kiểm Tra Lại Dữ Liệu Tìm Kiếm:', 'Dữ Liệu Tìm Kiếm Sai');
                    }
                }


                function isValidVietnamesePhoneNumber(phoneNumber) {
                    var regex = /^(0[23456789]|84[23456789])(\d{8})$/;
                    return regex.test(phoneNumber);
                }

                function isInputNumber(inputText) {
                    return /^\d+$/.test(inputText);
                }

                function containsOnlySpaces(inputText) {
                    return /^ *$/.test(inputText);
                }

                function displayPage(number, total) {
                    $('#hienThiBanGhi').empty();
                    var htmlPage = '<div className="hint-text">';
                    htmlPage += '<p style="color: #333">';
                    htmlPage += 'Hiển thị <b>' + number + '</b> / <b>' + total + '</b> bản ghi.';
                    htmlPage += '</p>';
                    htmlPage += '</div>';
                    $('#hienThiBanGhi').append(htmlPage);
                }

                // hàm để cập nhật phân trang
                function updatePagination() {
                    var pagination = $(".pagination");
                    pagination.empty();

                    var previousPage = currentPage - 1;
                    var nextPage = currentPage + 1;

                    pagination.append("<li class='page-item'><a class='page-link' href='#' aria-label='Previous'><span aria-hidden='true'>&laquo;</span></a></li>");

                    for (var i = 1; i <= totalPages; i++) {
                        var pageItem = "<li class='page-item'><a class='page-link' href='#'>" + i + "</a></li>";
                        if (i === currentPage) {
                            pageItem = "<li class='page-item active'><a class='page-link' href='#'>" + i + "</a></li>";
                        }
                        pagination.append(pageItem);
                    }

                    pagination.append("<li class='page-item'><a class='page-link' href='#' aria-label='Next'><span aria-hidden='true'>&raquo;</span></a></li>");

                    if (previousPage < 1) {
                        $(".pagination li:first").addClass("disabled");
                    }

                    if (nextPage > totalPages) {
                        $(".pagination li:last").addClass("disabled");
                    }
                }

                // xử lý sự kiện khi người dùng chọn trang
                $('.pagination').on('click', 'a.page-link', function (e) {
                    e.preventDefault();
                    var pageText = $(this).text();
                    if (pageText === "«") {
                        if (currentPage > 1) {
                            currentPage--;
                            displayData();
                            autoSelectFirstRow();
                        }
                    } else if (pageText === "»") {
                        if (currentPage < totalPages) {
                            currentPage++;
                            displayData();
                            autoSelectFirstRow();
                        }
                    } else {
                        currentPage = parseInt(pageText);
                        displayData();
                        autoSelectFirstRow();
                    }
                });
                displayData();
                autoSelectFirstRow();
            });
        }

        function processSelectChange() {
            var selectedValue = $('#select-service-list-order').val();
            console.log(selectedValue);
            $.ajax({
                url: '/api/v1/staff/dich-vu-san-bong/danh-sach-dich-vu',
                method: 'GET',
                success: function (apiResponse) {
                    if (apiResponse && Array.isArray(apiResponse)) {
                        $('#dataDichVuDoThueNuocUong').empty();
                        apiResponse.forEach(function (item) {
                            //Nuoc Uong
                            var id = item.id;
                            var image = item.image;
                            var gia = item.donGia;
                            var soLuong = item.soLuong;
                            var tenDichVu = item.tenDichVu;
                            var trangThai = item.trangThai;
                            if (selectedValue == 0) {
                                var htmlContent2 = '<div class="col-md-3 col-sm-3 col-4">';
                                htmlContent2 += '<div class="card card-product">';
                                htmlContent2 += '<div id="checkboxContainerList" style="display: none; position: absolute; top: 10px; left: 10px">';
                                htmlContent2 += '<input type="checkbox" style="width: 20px; height: 20px; margin-right: 5px" id="checkBoxListService"/>';
                                htmlContent2 += '</div>';
                                htmlContent2 += '<img src="data:image/png;base64,' + image + '" class="card-img-top" alt="..." />';
                                htmlContent2 += '<div class="card-body">';
                                htmlContent2 += '<h5 class="card-title text-center">' + tenDichVu + '</h5>';
                                htmlContent2 += '<span class="price" type="number">' + formatCurrencyVND(gia) + ' VNĐ</span>';
                                htmlContent2 += '<div class="form-group form-group-list-service-order">';
                                htmlContent2 += '<label class="form-label" for="quantity">Kho Còn : ' + soLuong + '</label>';
                                htmlContent2 += '</div>';
                                htmlContent2 += '</div>';
                                htmlContent2 += '<div class="card-footer bg-white">';
                                htmlContent2 += '<div class="d-grid gap-2 d-md-flex justify-content-md-end">';
                                htmlContent2 += '<input max="12" min="1" value="1" type="number" class="soluong" id="quantity" onchange="validatePositiveNumberInput(this, ' + soLuong + ')"  data-initial-quantity="' + 1 + '"/>';
                                htmlContent2 += '<button id="addDichVuHoaDon" type="button" class="btn btn-success btn-labeled-sm" data-ten-dich-vu="' + tenDichVu + '" data-gia-dich-vu="' + gia + '" data-id="' + id + '" data-trang-thai="' + trangThai + '">Thêm</button>';
                                htmlContent2 += '</div>';
                                htmlContent2 += '</div>';
                                htmlContent2 += '</div>';
                                htmlContent2 += '</div>';
                                $('#dataDichVuDoThueNuocUong').append(htmlContent2);
                            } else if (trangThai == selectedValue) {
                                var htmlContent2 = '<div class="col-md-3 col-sm-3 col-4">';
                                htmlContent2 += '<div class="card card-product">';
                                htmlContent2 += '<div id="checkboxContainerList" style="display: none; position: absolute; top: 10px; left: 10px">';
                                htmlContent2 += '<input type="checkbox" style="width: 20px; height: 20px; margin-right: 5px" id="checkBoxListService"/>';
                                htmlContent2 += '</div>';
                                htmlContent2 += '<img src="data:image/png;base64,' + image + '" class="card-img-top" alt="..." />';
                                htmlContent2 += '<div class="card-body">';
                                htmlContent2 += '<h5 class="card-title text-center">' + tenDichVu + '</h5>';
                                htmlContent2 += '<span class="price" type="number">' + formatCurrencyVND(gia) + ' VNĐ</span>';
                                htmlContent2 += '<div class="form-group form-group-list-service-order">';
                                htmlContent2 += '<label class="form-label" for="quantity">Kho Còn : ' + soLuong + '</label>';
                                htmlContent2 += '</div>';
                                htmlContent2 += '</div>';
                                htmlContent2 += '<div class="card-footer bg-white">';
                                htmlContent2 += '<div class="d-grid gap-2 d-md-flex justify-content-md-end">';
                                htmlContent2 += '<input max="12" min="1" value="1" type="number" class="soluong" id="quantity" onchange="validatePositiveNumberInput(this,' + soLuong + ')"  data-initial-quantity="' + 1 + '"/>';
                                htmlContent2 += '<button id="addDichVuHoaDon" type="button" class="btn btn-success btn-labeled-sm" data-ten-dich-vu="' + tenDichVu + '" data-gia-dich-vu="' + gia + '" data-id="' + id + '" data-trang-thai="' + trangThai + '">Thêm</button>';
                                htmlContent2 += '</div>';
                                htmlContent2 += '</div>';
                                htmlContent2 += '</div>';
                                htmlContent2 += '</div>';
                                $('#dataDichVuDoThueNuocUong').append(htmlContent2);
                            }
                        });
                    }
                },
                error: function (error) {
                    console.error('API Request Failed:', error);
                }
            });
        }

        $(document).on('click', '#buttonThemPhuPhiHoaDon', function () {
            displayPhuPhiHoaDon(getId);
        });
        $(document).on('click', '#saveNewPhuPhi', function () {
            var tenPhuPhi = $("#tenPhuPhi").val();
            var giaPhuPhi = parseFloat(document.getElementById('giaPhuPhi').value) || 0;
            $('#tienTraLai').val();
            $('#tienKhachDua').val();

            if (tenPhuPhi == '') {
                $('#tenPhuPhi').val('').css('border-color', 'red');
            } else {
                $('#tenPhuPhi').css('border-color', '');
            }
            if (giaPhuPhi === 0) {
                $('#giaPhuPhi').val(0).css('border-color', 'red');
            } else {
                $('#giaPhuPhi').css('border-color', '');
            }
            if (tenPhuPhi != '' && giaPhuPhi !== 0) {
                Swal.fire({
                    title: 'Chắc Chắn Xác Nhận Thêm Phụ Phí!',
                    text: 'Xin chào!',
                    icon: 'success',
                    confirmButtonText: 'Đồng Ý'
                }).then((result) => {
                    if (result.isConfirmed) {
                        $.ajax({
                            url: "/api/v1/staff/phu-phi-hoa-don/luu-phu-phi/" + getId,
                            method: "POST",
                            contentType: 'application/json',
                            data: JSON.stringify({
                                tenPhuPhi: tenPhuPhi,
                                giaPhuPhi: giaPhuPhi
                            }),
                            success: function (data) {
                                displayPhuPhiHoaDon(getId);
                            },
                            error: function (error) {
                                console.log("Error:", error);
                            }
                        });
                        createAndShowToast('bg-success', 'Thêm Phụ Phí Thành Công :', tenPhuPhi + ' ' + formatCurrencyVND(giaPhuPhi) + '.VNĐ');
                        $('#tenPhuPhi').val('');
                        $('#giaPhuPhi').val(0);
                    }
                });
            }


        });

        $(document).on('click', '#buttonXoaPhuPhiHoaDon', function () {
            Swal.fire({
                title: 'Chắc Chắn Xác Nhận Xóa Phụ Phí!',
                text: 'Xin chào!',
                icon: 'success',
                confirmButtonText: 'Đồng Ý'
            }).then((result) => {
                if (result.isConfirmed) {
                    var idPhuPhiHoaDon = $(this).data('id');
                    var tenPhuPhi = $(this).data('ten-phu-phi');
                    var giaPhuPhi = $(this).data('gia-phu-phi');
                    $('#tienTraLai').empty();
                    $('#tienKhachDua').empty();
                    $.ajax({
                        url: '/api/v1/staff/phu-phi-hoa-don/xoa-phu-phi/' + idPhuPhiHoaDon,
                        method: 'DELETE',
                        success: function (response) {
                            displayPhuPhiHoaDon(getId);
                        },
                        error: function (error) {
                            console.error('API Request Failed:', error);
                        }
                    });
                    createAndShowToast('bg-success', 'Xóa Phụ Phí Thành Công :', tenPhuPhi + ' ' + formatCurrencyVND(giaPhuPhi) + '.VNĐ');
                }
            });

        });

        function displayPhuPhiHoaDon(getId) {
            $('#dataPhuPhiHoaDon').empty();
            $('#selectPhuPhi').empty();
            $('#tienTraLai').empty();
            $('#tienKhachDua').empty();
            $('#tienPhuPhi').val(0);
            tongGiaTienPhuPhi = 0;
            $.ajax({
                url: "/api/v1/staff/phu-phi-hoa-don/get-by-id-hoa-don/" + getId,
                method: "GET",
                success: function (data) {
                    if (data.length > 0) {
                        $('#thongBaoPhuPhi').empty();
                        $('#tablePhuPhi').show();
                        $.each(data, function (index, item) {
                            var htmlHoaDonPhuPhi = '<tr>';
                            htmlHoaDonPhuPhi += '<th scope="row">' + (index + 1) + '</th>';
                            htmlHoaDonPhuPhi += '<td>' + item.tenPhuPhi + '</td>';
                            htmlHoaDonPhuPhi += '<td>' + formatCurrencyVND(item.giaPhuPhi) + '.VNĐ' + '</td>';
                            htmlHoaDonPhuPhi += '<td>';
                            htmlHoaDonPhuPhi += '<button type="button" id="buttonXoaPhuPhiHoaDon" data-gia-phu-phi="' + item.giaPhuPhi + '" data-ten-phu-phi="' + item.tenPhuPhi + '" data-id="' + item.idPhuPhiHoaDon + '" data-phu-phi="' + item.idPhuPhi + '"  class="btn btn-danger btn-labeled-sm">Xóa</button>';
                            htmlHoaDonPhuPhi += '</td>';
                            htmlHoaDonPhuPhi += '</tr>';
                            $('#dataPhuPhiHoaDon').append(htmlHoaDonPhuPhi);
                            var option = $('<option>', {
                                value: item.idPhuPhi,
                                text: (item.tenPhuPhi + ' GIÁ ' + [formatCurrencyVND(item.giaPhuPhi) + '.VNĐ'])
                            });
                            $('#selectPhuPhi').append(option);
                            tongGiaTienPhuPhi += item.giaPhuPhi;
                        });
                        tongTienSanCaSaveThongKe = (parseFloat(tongTienDichVu) + parseFloat(tongTienSanCa) + parseFloat(tongGiaTienPhuPhi) - (parseFloat(tongTienCoc) + parseFloat(tongTienCocThua)));
                        $('#tienPhuPhi').val(formatCurrencyVND(tongGiaTienPhuPhi));
                        $('#tongThanhToan').text(formatCurrencyVND((parseFloat(tongTienDichVu) + parseFloat(tongTienSanCa) + parseFloat(tongGiaTienPhuPhi) - (parseFloat(tongTienCoc) + parseFloat(tongTienCocThua)))) + '.VNĐ');
                    } else {
                        $('#thongBaoPhuPhi').empty();
                        $('#tablePhuPhi').hide();
                        var htmlHoaDonPhuPhi = '<div class="alert alert-danger noContent" role="alert">';
                        htmlHoaDonPhuPhi += '<h1 class="" style="font-size: 20px">Chưa Phát Sinh Phụ Phí!</h1>';
                        htmlHoaDonPhuPhi += '</div>';
                        $('#thongBaoPhuPhi').append(htmlHoaDonPhuPhi);
                        var option = $('<option>', {
                            text: 'Chưa Có Phụ Phí Được Thêm Vào!',
                        });
                        $('#selectPhuPhi').append(option);
                    }
                },
                error: function (error) {
                    console.log("Error:", error);
                }
            });
        }

        $(document).ready(function () {
            $("#btnThanhToanHoaDon").click(function () {
                var paymentMethod = $("input[name='phuongThucChuyenKhoan']:checked").val();
                if (paymentMethod == "tienMat") {
                    var tienKhachDua = parseFloat(document.getElementById('tienKhachDua').value) || 0;
                    console.log(tienKhachDua);
                    if (tienKhachDua === 0 || tienKhachDua < tongTienHoaDonPhaiTra) {
                        showMessageThanhToanWarning();
                        $('#tienKhachDua').css('border-color', 'red');
                    }
                    if (tienKhachDua >= tongTienHoaDonPhaiTra) {
                        thanhToanTienMat();
                        $('#tienKhachDua').css('border-color', '')
                    }
                } else if (paymentMethod == "chuyenKhoan") {
                    thanhToanChuyenKhoan();
                }
            });
        });


        function clearForm() {
            $('#dataNuocUong').empty();
            $('#dataDoThue').empty();
            $('#tienTraLai').val(0);
            $('#tienKhachDua').val(0);
            $('#tienSan').val(0);
            $('#tienCocSan').val(0);
            $('#tienCocThua').val(0);
            $('#tenKhachHang').val('');
            $('#tienDichVu').val(0);
            $('#selectPhuPhi').empty();
            $('#tienPhuPhi').val(0);
            $('#soDienThoai').val('');
            $('#tenSan').val('');
            $('#thoiGianDa').val('');
            $('#thoiGianCheckIn').val('');
            $('#tongThanhToan').text('0' + '.VNĐ');
        }

        function showMessageThanhToan() {
            var tenKhachHang = $("#tenKhachHang").val();
            var tenSan = $("#tenSan").val();
            clearForm();
            createAndShowToast('bg-success', 'Thanh Toán Thành Công :', tenKhachHang + ' : ' + tenSan + ' : ' + formatCurrencyVND(tongTienHoaDonPhaiTra) + '.VNĐ');
        }

        function showMessageThanhToanWarning() {
            var tenKhachHang = $("#tenKhachHang").val();
            var tenSan = $("#tenSan").val();
            createAndShowToast('bg-warning', 'Thanh Toán Chưa Thành Công :', tenKhachHang + ' : ' + tenSan + ' : ' + formatCurrencyVND(tongTienHoaDonPhaiTra) + '.VNĐ');
        }

        function thanhToanChuyenKhoan() {
            var tenKhachHang = $("#tenKhachHang").val();
            var tenSan = $("#tenSan").val();
            Swal.fire({
                title: 'Chắc Chắn Xác Nhận Thanh Toán Hóa Đơn : ' + tenKhachHang + ' : ' + tenSan,
                text: 'Xin chào!',
                icon: 'success',
                confirmButtonText: 'Đồng Ý'
            }).then((result) => {
                if (result.isConfirmed) {
                    var tenKhachHang = $("#tenKhachHang").val();
                    var soDienThoai = $("#soDienThoai").val();
                    $.ajax({
                        type: "POST",
                        url: "/api/v1/staff/thanh-toan-chuyen-khoan",
                        data: {
                            idHoaDonSanCa: getId,
                            amount: tongTienSanCaSaveThongKe,
                            orderInfo: soDienThoai,
                        },
                        success: function (response) {
                            window.open(response);
                        },
                        error: function (error) {
                            console.error("Lỗi Ajax: ", error);
                        }
                    });
                }
            });

        }

        function thanhToanTienMat() {
            var tenKhachHang = $("#tenKhachHang").val();
            var tenSan = $("#tenSan").val();
            Swal.fire({
                title: 'Chắc Chắn Xác Nhận Thanh Toán Hóa Đơn : ' + tenKhachHang + ' : ' + tenSan,
                text: 'Xin chào!',
                icon: 'success',
                confirmButtonText: 'Đồng Ý'
            }).then((result) => {
                if (result.isConfirmed) {
                    var paymentMethod = $("input[name='phuongThucChuyenKhoan']:checked").val();
                    var tongTien = tongTienSanCaSaveThongKe;
                    console.log(tongTien);
                    $.ajax({
                        type: "POST",
                        url: "/api/v1/staff/thanh-toan-tien-mat/" + getId,
                        data: {
                            paymentMethod: paymentMethod,
                            tongTienSave: tongTien
                        },
                        success: function (response) {
                            showDataTableViewThanhToan();
                            showMessageThanhToan();
                        },
                        error: function (error) {
                            console.error("Lỗi Ajax: ", error);
                        }
                    });
                }
            });
        }
    });

    function clearTienKhachDua() {
        document.getElementById('tienKhachDua').value = "";
        document.getElementById('tienTraLai').value = "";
    }

    function formatCurrencyVND(amount, locale = 'vi-VN') {
        const formatter = new Intl.NumberFormat(locale, {style: 'currency', currency: 'VND'});
        const parts = formatter.formatToParts(amount);

        const formattedAmount = parts.map(part => {
            switch (part.type) {
                case 'currency':
                    return '';
                case 'decimal':
                    return '.';
                default:
                    return part.value;
            }
        }).join('');

        return formattedAmount;
    }

    function formatDate(inputDateString) {
        var date = new Date(inputDateString);
        var day = date.getDate();
        var month = date.getMonth() + 1;
        var year = date.getFullYear();
        var formattedDate = day + ' - ' + month + ' - ' + year;
        return formattedDate;
    }

    function calculateChange() {
        var tienKhachDua = parseFloat(document.getElementById('tienKhachDua').value) || 0;

        if (tienKhachDua >= tongTienHoaDonPhaiTra) {
            var tienTraLai = tienKhachDua - tongTienHoaDonPhaiTra;

            document.getElementById('tienTraLai').value = formatCurrencyVND(tienTraLai);
        } else {
            document.getElementById('tienTraLai').value = "Chưa đủ tiền trả";
        }
    }

    function createAndShowToast(backGround, headerText, bodyText) {
        const toastContainer = document.getElementById("toastContainer");
        const toastsContainer = document.getElementById("toasts");
        const maxToasts = 5;
        const toastsArray = [];
        let toastCounter = 1;

        toastCounter++;
        const toast = document.createElement("div");
        toast.className = "toast mb-2";
        toast.setAttribute("role", "alert");
        toast.setAttribute("aria-live", "assertive");
        toast.setAttribute("aria-atomic", "true");

        toast.innerHTML = `
          <div class="toast-header  ${backGround}" style="border-radius:5px 5px 0px 0px">
            <div class="mx-1">
              <i class="far fa-futbol fa-lg" style="color: #ffffff"></i>
            </div>
            <strong class="me-auto" style="color: #ffffff">${headerText}</strong>
            <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
          </div>
          <div class="toast-body p-2" style="color: black; font-size: 14px;background-color: #ffffff;border-radius:0px 0px 5px 5px ">
            ${bodyText}
          </div>
        `;

        // thằng bố add thằng toast là con
        toastContainer.appendChild(toast);

        // hiển thị toast
        const toastInstance = new bootstrap.Toast(toast, {
            animation: true,
            autohide: true,
            delay: 5000,
        });

        // hiển thị ra toast
        toastInstance.show();

        toastsArray.forEach((toast) => {
            toast.addEventListener("hidden.bs.toast", function () {
                toast.remove();
                if (toastInnerContainer.childElementCount === 0) {
                    toastContainer.remove();
                }
            });
        });

        toastsArray.push(toast);
    }

</script>
<script>
    function toggleInputs() {
        var tienKhachDuaContainer = document.getElementById('tienKhachDuaContainer');

        var tienMatRadio = document.getElementById('tienMat');
        if (tienMatRadio.checked) {
            tienKhachDuaContainer.style.display = 'block';
        } else {
            tienKhachDuaContainer.style.display = 'none';
        }
    }

    toggleInputs();

    function validatePositiveNumberInput(input, maxValue) {
        // Get the input value
        var inputValue = $(input).val();
        if (isNaN(inputValue) || parseFloat(inputValue) <= 0) {
            var initialQuantity = $(input).data('initial-quantity');
            $(input).val(initialQuantity);
            createAndShowToast('bg-warning', 'Số Lượng Sai :', inputValue);
        }
        if (isNaN(inputValue) || parseFloat(inputValue) >= maxValue) {
            $(input).val(maxValue);
            createAndShowToast('bg-warning', 'Qúa Số Lượng :', 'Số Lượng Lớn Nhất: ' + maxValue);
        }
    }

    function getSelectedIds() {
        var selectedIds = [];

        // Lặp qua tất cả các ô checkbox trong bảng ------------------------------------------------------------------------
        var checkboxes = document.querySelectorAll('input[type="checkbox"].form-check-input');
        checkboxes.forEach(function (checkbox) {
            if (checkbox.checked) {
                selectedIds.push(checkbox.value);
            }
        });

        return selectedIds;
    }

    function thongBao() {
        Swal.fire({
            title: 'Chắc Chắn Xác Nhận!',
            text: 'Xin chào!',
            icon: 'success',
            confirmButtonText: 'OKE'
        }).then((result) => {
            if (result.isConfirmed) {
                location.reload();
            }
        });
    }
</script>

<!-- Add Bootstrap JS and jQuery links -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<!-- UPDATE 2/11/023 -->
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
