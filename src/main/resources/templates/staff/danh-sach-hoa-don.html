<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="description" content=""/>
    <meta
            name="author"
            content="Mark Otto, Jacob Thornton, and Bootstrap contributors"
    />
    <meta name="generator" content="Hugo 0.84.0"/>
    <link rel="website icon" type="png"
          href="https://img.freepik.com/premium-vector/soccer-ball-logo-illustration-vector_472355-210.jpg?w=2000">

    <title>Sân Bóng Đồng Đế</title>
    <link
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css"
            rel="stylesheet"
    />
    <!-- Quan Trọng -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <!--  -->
    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com"/>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
    <link
            href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;500&family=Roboto:wght@400;500;700&display=swap"
            rel="stylesheet"
    />

    <!-- Icon Font Stylesheet -->
    <link
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css"
            rel="stylesheet"
    />
    <link
            href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css"
            rel="stylesheet"
    />

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com"/>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
    <link
            href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;500&family=Roboto:wght@400;500;700&display=swap"
            rel="stylesheet"
    />
    <!-- Icon Font Stylesheet -->
    <link
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css"
            rel="stylesheet"
    />
    <link
            href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css"
            rel="stylesheet"
    />
    <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"
            integrity="sha512-MV7K8+y+gLIBoVD59lQIYicR65iaqukzvf/nwasF0nqhPay5w/9lJmVM2hMDcnK1OnMGCdVK+iQrJ7lzPJQd1w=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
    />
    <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM"
            crossorigin="anonymous"
    />
    <link
            rel="stylesheet"
            href="https://use.fontawesome.com/releases/v5.5.0/css/all.css"
            integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU"
            crossorigin="anonymous"
    />
    <link
            href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.6.0/dist/bootstrap-icons.min.css"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>

    <link
            rel="canonical"
            href="https://getbootstrap.com/docs/5.0/examples/grid/"
    />

    <!-- Add Bootstrap CSS link -->
    <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css"
            rel="stylesheet"
    />
    <!-- <link href="./grid.css" /> -->
    <script src="../../static/js/staff/danh-sach-hoa-don.js"></script>
    <style>
        .selected-row {
            background-color: #d3d3d3;
        }
    </style>
</head>

<body>
<header th:insert="~{fragments/header-admin}"></header>

<div>
    <div class="row">
        <div class="col-12 mt-4">
            <div
                    class="card p-3"
                    style="background-color: rgba(40, 38, 38, 0.196)"
            >
                <p class="mb-0 fw-bold h5 text-center">Hóa Đơn Đặt Lịch</p>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-9">
            <div class="card p-3">
                <div class="card-body border p-0">
                    <div class="container mt-5">
                        <div class="table-responsive">
                            <table class="table table-bordered" id="myTable">
                                <tbody id="myTableBody">
                                <!-- Nội dung cập nhật bằng JavaScript -->
                                </tbody>
                            </table>
                            <div class="d-flex justify-content-center"> <!-- Center horizontally -->
                                <nav aria-label="Page navigation">
                                    <ul class="pagination">
                                        <li class="page-item">
                                            <a class="page-link" href="#" aria-label="Previous">
                                                <span aria-hidden="true">&laquo;</span>
                                            </a>
                                        </li>
                                        <li class="page-item active"><a class="page-link" href="#">1</a></li>
                                        <li class="page-item"><a class="page-link" href="#">2</a></li>
                                        <li class="page-item"><a class="page-link" href="#">3</a></li>
                                        <li class="page-item">
                                            <a class="page-link" href="#" aria-label="Next">
                                                <span aria-hidden="true">&raquo;</span>
                                            </a>
                                        </li>
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card p-3">
                <div class="card-body border p-0">
                    <div class="info-display">
                        <form method="GET">
                            <div class="mb-3">
                                <label for="tenKhachHang">Tên Khách Hàng</label>
                                <input type="text" class="form-control" id="tenKhachHang" readonly>
                            </div>
                            <div class="mb-3">
                                <label for="soDienThoai">Số Điện Thoại</label>
                                <input type="text" class="form-control" id="soDienThoai" readonly>
                            </div>
                            <div class="mb-3">
                                <label for="tenSan">Tên Sân Ca</label>
                                <input type="text" class="form-control" id="tenSan" readonly>
                            </div>
                            <div class="mb-3">
                                <label for="thoiGianDa">Thời Gian Đá</label>
                                <input type="text" class="form-control" id="thoiGianDa" readonly>
                            </div>
                            <div class="mb-3">
                                <label for="tienSan">Tiền Sân</label>
                                <input type="text" class="form-control" id="tienSan" readonly>
                            </div>
                            <div class="mb-3">
                                <label for="tienDichVu">Tiền Dịch Vụ</label>
                                <input type="text" class="form-control" id="tienDichVu" readonly>
                            </div>
                            <div
                                    class="card p-3"
                                    style="background-color: rgba(70, 64, 64, 0.196)"
                            >
                                <p class="mb-0 fw-bold h5 text-center">
                                    Thanh Toán
                                </p>
                            </div>
                            <div class="col-xs-12 mt-5 mb-3">
                                <div class="">
                                    <h4
                                            style="
                        font-family: Tahoma;
                        font-weight: 500;
                        text-align: center;
                        color: rgb(215, 92, 92);
                      "
                                    >
                                        Tổng Thanh Toán: <span id="tongThanhToan">0</span></h4>
                                    </h4>
                                </div>
                                <br>
                            </div>
                            <div class="form-group">
                                <hr/>
                            </div>
                            <div class="form-group">
                                <div class="col-md-12 text-center">
                                    <button
                                            type="submit"
                                            id="submitBtn"
                                            class="btn btn-danger"
                                            style="border-radius: 10px"
                                    >
                                        THÊM DỊCH VỤ HOẶC THANH TOÁN
                                    </button>
                                    <br>
                                </div>
                                <br>
                            </div>
                        </form>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>
<script>
    $(document).ready(function () {
        var getId;
        $.get("/api/v1/staff/thanh-toan/get-all", function (data) {
            var table = $("#myTable");

            // Tạo phần <thead> và các thẻ tiêu đề
            var thead = document.createElement('thead');
            thead.className = 'table-light';
            var headerRow = document.createElement('tr');
            var headers = ['TÊN KHÁCH', 'ĐIỆN THOẠI', 'TÊN SÂN CA', 'THỜI GIAN ĐÁ', 'NGÀY ĐẶT LỊCH', 'TỔNG TIỀN', 'TRẠNG THÁI'];
            for (var i = 0; i < headers.length; i++) {
                var th = document.createElement('th');
                th.scope = 'col';
                th.textContent = headers[i];
                headerRow.appendChild(th);
            }
            thead.appendChild(headerRow);

            //<thead> vào bảng
            table.prepend(thead);

            //<tbody> với dữ liệu
            var tableBody = $("#myTableBody");
            tableBody.empty();

            //mục trang và trang hiện tại
            var pageSize = 10;
            var currentPage = 1;
            var totalPages = Math.ceil(data.length / pageSize);

            //hiển thị dữ liệu dựa trên trang hiện tại
            function displayData() {
                tableBody.empty();
                var startIndex = (currentPage - 1) * pageSize;
                var endIndex = Math.min(startIndex + pageSize, data.length);

                for (var i = startIndex; i < endIndex; i++) {
                    var item = data[i];
                    var row = document.createElement('tr');

                    row.dataset.id = item.id;
                    row.dataset.soDienThoai = item.soDienThoai;
                    row.dataset.tenKhachHang = item.tenKhachHang;
                    row.dataset.tenSanBong = item.tenSanBong;
                    row.dataset.tenLoaiSan = item.tenLoaiSan;
                    row.dataset.tenCa = item.tenCa;
                    row.dataset.thoiGianBatDau = item.thoiGianBatDau;
                    row.dataset.thoiGianKetThuc = item.thoiGianKetThuc;
                    row.dataset.tongTienSanCa = item.tongTienSanCa;
                    row.dataset.tongTienDichVu = item.tongTienDichVu;
                    row.dataset.tongTienThanhToan = item.tongTienThanhToan;


                    //ô dữ liệu và thêm dữ liệu vào
                    var cell1 = document.createElement('td');
                    cell1.textContent = item.tenKhachHang;
                    var cell2 = document.createElement('td');
                    cell2.textContent = item.soDienThoai;
                    var cell3 = document.createElement('td');
                    cell3.textContent = item.tenSanBong + " - " + item.tenCa;
                    var cell4 = document.createElement('td');
                    cell4.textContent = item.thoiGianBatDau + " - " + item.thoiGianKetThuc;
                    var cell5 = document.createElement('td');
                    cell5.textContent = item.ngayDatLich;
                    var cell6 = document.createElement('td');
                    cell6.textContent = item.tongTienThanhToan;
                    var cell7 = document.createElement('td');
                    //trạng thái và hiển thị 'true' nếu trạng thái là 1
                    cell7.textContent = item.trangThai === 1 ? 'CHƯA THANH TOÁN' : 'ĐÃ THANH TOÁN';

                    //các ô vào hàng
                    row.appendChild(cell1);
                    row.appendChild(cell2);
                    row.appendChild(cell3);
                    row.appendChild(cell4);
                    row.appendChild(cell5);
                    row.appendChild(cell6);
                    row.appendChild(cell7);

                    //sự kiện khi nhấp vào hàng
                    row.addEventListener('click', function () {
                        tableBody.find('tr').removeClass('selected-row');
                        $(this).addClass('selected-row');
                        getId = this.dataset.id;
                        $('#tenKhachHang').val(this.dataset.tenKhachHang);
                        $('#soDienThoai').val(this.dataset.soDienThoai);
                        $('#tenSan').val(this.dataset.tenSanBong + ' - ' + this.dataset.tenCa + ' - ' + this.dataset.tenLoaiSan);
                        $('#thoiGianDa').val(this.dataset.thoiGianBatDau + ' - ' + this.dataset.thoiGianKetThuc);
                        $('#tienSan').val(this.dataset.tongTienSanCa);
                        $('#tienDichVu').val(this.dataset.tongTienDichVu);
                        $('#tongThanhToan').text(this.dataset.tongTienThanhToan);
                    });

                    tableBody.append(row);
                }

                updatePagination();
            }
            $('#submitBtn').on('click', function (e) {
                e.preventDefault();

                // lấy giá trị id từ nơi bạn lưu trữ nó
                var id = getId;

                // tạo URL bằng cách thêm id vào đường dẫn
                var url = "/api/v1/staff/thanh-toan/get-one/" + id;

                // chuyển hướng trình duyệt đến URL mới
                window.location.href = url;
            });
            // hàm để cập nhật phân trang
            function updatePagination() {
                var pagination = $(".pagination");
                pagination.empty();

                var previousPage = currentPage - 1;
                var nextPage = currentPage + 1;

                pagination.append("<li class='page-item'><a class='page-link' href='#' aria-label='Previous'><span aria-hidden='true'>&laquo;</span></a></li>");

                for (var i = 1; i <= totalPages; i++) {
                    var pageItem = "<li class='page-item'><a class 'page-link' href='#'>" + i + "</a></li>";
                    if (i === currentPage) {
                        pageItem = "<li class='page-item active'><a class='page-link' href='#'>" + i + "</a></li>";
                    }
                    pagination.append(pageItem);
                }

                pagination.append("<li class='page-item'><a class='page-link' href='#' aria-label='Next'><span aria-hidden='true'>&raquo;</span></a></li>");

                if (previousPage < 1) {
                    $(".pagination li:first").addClass("disabled");
                }

                if (nextPage > totalPages) {
                    $(".pagination li:last").addClass("disabled");
                }
            }

            // xử lý sự kiện khi người dùng chọn trang
            $('.pagination').on('click', 'a.page-link', function (e) {
                e.preventDefault();
                var pageText = $(this).text();
                if (pageText === "«") {
                    if (currentPage > 1) {
                        currentPage--;
                        displayData();
                    }
                } else if (pageText === "»") {
                    if (currentPage < totalPages) {
                        currentPage++;
                        displayData();
                    }
                } else {
                    currentPage = parseInt(pageText);
                    displayData();
                }
            });
            displayData();
        });
    });

</script>
<!-- Add Bootstrap JS and jQuery links -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.min.js"></script>
</body>
</html>
